@* File: Views/SupportRequest/Create.cshtml *@
@model Tourest.ViewModels.SupportRequest.MySupportRequestsViewModel
@{
    ViewData["Title"] = "Gửi yêu cầu hỗ trợ";
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collapsible Chat</title>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
          rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
          rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.3.2/mdb.min.css"
          rel="stylesheet" />

    <style>
        #chat4 .form-control {
            border-color: transparent;
        }

            #chat4 .form-control:focus {
                border-color: transparent;
                box-shadow: inset 0px 0px 0px 1px transparent;
            }

        .divider:after,
        .divider:before {
            content: "";
            flex: 1;
            height: 1px;
            background: #eee;
        }
        /* Tùy chọn: Cải thiện style cho ảnh đại diện */
        .chat-avatar {
            width: 45px;
            height: 45px; /* Đặt chiều cao cố định */
            object-fit: cover; /* Đảm bảo ảnh không bị méo */
            flex-shrink: 0; /* Ngăn ảnh bị co lại trong flex container */
        }
        /* Đảm bảo thanh cuộn hiển thị đúng */
        .chat-body-scroll {
            position: relative;
            height: 400px;
            overflow-y: auto; /* Luôn hiển thị thanh cuộn nếu nội dung dài */
        }

        /* --- CSS TÙY CHỈNH CHO MÀU #039e9d --- */
        .custom-chat-button {
            background-color: #039e9d !important; /* Màu nền mới */
            border-color: #039e9d !important; /* Đổi cả màu viền cho nhất quán */
            color: white; /* Giữ chữ màu trắng */
        }

            /* Tùy chọn: Thêm hiệu ứng khi rê chuột qua nút */
            .custom-chat-button:hover {
                background-color: #028a89 !important; /* Làm màu tối hơn một chút khi hover */
                border-color: #028a89 !important;
            }


        .message-outgoing-custom {
            background-color: #039e9d; /* Màu nền mới cho tin nhắn đi */
            color: white; /* Giữ chữ màu trắng */
        }
        /* --- KẾT THÚC CSS TÙY CHỈNH --- */

    </style>
</head>
<body>
    @* Hiển thị thông báo thành công/lỗi từ TempData *@
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            @TempData["SuccessMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }
    @if (TempData["ErrorMessage"] != null)
    {
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            @TempData["ErrorMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    <section class="breadcrumb__section section-padding-top-bottom"
    style="--bg-image: url('@Url.Content("~/assets/images/breadcrumb-section/breadcrumb.png")');">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="breadcrumb__content">
                        <h1 class="breadcrumb-title">Support</h1>
                        <nav>
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item">
                                    <a href="index.html">home</a>
                                </li>
                                <li class="breadcrumb-item active" aria-current="page">
                                    blog
                                </li>
                            </ol>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Breadcrumb__section end  -->
    <!-- faq__section start  -->
    <section class="faq__section section-padding-top-bottom">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="section__header">
                        <h4 class="section__sub-title">Popular Questions</h4>
                        <h2 class="section__title title-anim">
                            Câu hỏi thường gặp
                        </h2>
                    </div>
                </div>
            </div>

            <div class="row justify-content-center section-mini-padding-top">
                <div class="col-lg-9 col-xl-8">
                    <div class="row justify-content-center section-mini-padding-top">
                        <div>
                            <div class="faq__accordion accordion accordion-reset"
                                 id="faqAccordionExample">

                                <div class="accordion-item item-stagger">
                                    <h6 class="accordion-header">
                                        <button class="accordion-button collapsed"
                                                type="button"
                                                data-bs-toggle="collapse"
                                                data-bs-target="#collapseFour"
                                                aria-expanded="false"
                                                aria-controls="collapseFour">
                                            Tôi có thể hủy tour đã đặt không?
                                        </button>
                                    </h6>
                                    <div id="collapseFour"
                                         class="accordion-collapse collapse"
                                         data-bs-parent="#faqAccordionExample">
                                        <div class="accordion-body">
                                            Có, bạn có thể hủy tour theo chính sách của chúng tôi. Tùy thuộc vào thời điểm hủy, bạn có thể được hoàn tiền một phần hoặc toàn bộ. Vui lòng kiểm tra chính sách hủy tour trên website hoặc liên hệ đội ngũ hỗ trợ để biết thêm chi tiết.
                                        </div>
                                    </div>
                                </div>
                                <div class="accordion-item item-stagger">
                                    <h6 class="accordion-header">
                                        <button class="accordion-button collapsed"
                                                type="button"
                                                data-bs-toggle="collapse"
                                                data-bs-target="#collapseFive"
                                                aria-expanded="false"
                                                aria-controls="collapseFive">
                                            Tour du lịch của bạn có hướng dẫn viên không?
                                        </button>
                                    </h6>
                                    <div id="collapseFive"
                                         class="accordion-collapse collapse"
                                         data-bs-parent="#faqAccordionExample">
                                        <div class="accordion-body">
                                            Tất cả các tour của chúng tôi đều có hướng dẫn viên chuyên nghiệp, am hiểu về điểm đến và luôn sẵn sàng hỗ trợ bạn trong suốt hành trình. Họ sẽ mang đến những trải nghiệm thú vị và thông tin bổ ích về văn hóa, lịch sử của nơi bạn tham quan.
                                        </div>
                                    </div>
                                </div>
                                <div class="accordion-item item-stagger">
                                    <h6 class="accordion-header">
                                        <button class="accordion-button collapsed"
                                                type="button"
                                                data-bs-toggle="collapse"
                                                data-bs-target="#collapseSix"
                                                aria-expanded="false"
                                                aria-controls="collapseSix">
                                            Tôi có thể đặt tour tùy chỉnh theo nhu cầu riêng không?
                                        </button>
                                    </h6>
                                    <div id="collapseSix"
                                         class="accordion-collapse collapse"
                                         data-bs-parent="#faqAccordionExample">
                                        <div class="accordion-body">
                                            Chắc chắn rồi! Chúng tôi cung cấp dịch vụ thiết kế tour du lịch theo yêu cầu cá nhân hoặc nhóm. Bạn chỉ cần gửi thông tin về điểm đến, thời gian và sở thích, chúng tôi sẽ tạo ra một hành trình độc đáo dành riêng cho bạn.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <div class="container mt-4">
                <div class="row mb-4 g-4">
                    <div class="col-md-6">
                        <div class="row">
                            <div>
                                <div class="section__header">
                                    <h4 class="section__sub-title">Have any question?</h4>
                                    <h2 class="section__title title-anim">Get in Touch</h2>
                                </div>
                                @* Giới hạn độ rộng form *@
                                <form asp-action="Create" asp-controller="SupportRequest" method="post">
                                    @Html.AntiForgeryToken() @* Chống CSRF *@

                                    @* Hiển thị lỗi tổng hợp (nếu có) *@
                                    <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

                                    <div class="mb-3">
                                        <label asp-for="NewRequest.Subject" style="font-weight: bold; color: #039e9d" class="form-label"></label>
                                        <input asp-for="NewRequest.Subject" class="form-control" />
                                        <span asp-validation-for="NewRequest.Subject" class="text-danger"></span>
                                    </div>

                                    <div class="mb-3">
                                        <label asp-for="NewRequest.Message" class="form-label" style="font-weight: bold; color: #039e9d"></label>
                                        <textarea asp-for="NewRequest.Message" class="form-control" rows="6"></textarea> @* Dùng textarea cho Message *@
                                        <span asp-validation-for="NewRequest.Message" class="text-danger"></span>
                                    </div>

                                    <div class="mb-3">
                                        <button type="submit" class="btn" style="font-weight: bold; background-color: #039e9d; color: white">
                                            Gửi yêu cầu
                                        </button>
                                        <a asp-action="Index" asp-controller="Home" style="font-weight: bold;" class="btn btn-outline-secondary ms-2">
                                            Hủy bỏ
                                        </a> @* Nút hủy về trang chủ *@
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <section>
                            <div class="container">

                                <div class="row d-flex justify-content-center">
                                    <div>

                                        <a data-mdb-ripple-init class="btn btn-lg btn-block custom-chat-button" data-mdb-collapse-init href="#collapseExample"
                                           role="button" aria-expanded="false" aria-controls="collapseExample">
                                            <div class="d-flex justify-content-between align-items-center">
                                                <span>Những câu hỏi đã được gửi đi</span>
                                                <i class="fas fa-chevron-down"></i>
                                            </div>
                                        </a>

                                        <div class="collapse mt-3" id="collapseExample">
                                            <div class="card" id="chat4">
                                                <div class="card-body chat-body-scroll" data-mdb-perfect-scrollbar-init>
                                                    @foreach (var request in Model.Requests)
                                                    {
                                                    <div class="d-flex flex-row justify-content-start mb-4">
                                                        <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava5-bg.webp"
                                                             alt="Avatar người gửi" class="chat-avatar">
                                                        <div class="ms-3">

                                                            <p class="small p-2 ms-3 mb-1 rounded-3 bg-body-tertiary">
                                                                    @request.Subject
                                                            </p>
                                                                @{
                                                                    var messageSnippet = request.Message.Length > 100 ? request.Message.Substring(0, 100) + "..." : request.Message;
                                                                }
                                                                <p class="small p-2 ms-3 mb-1 rounded-3 bg-body-tertiary">
                                                                    @messageSnippet
                                                                </p>

                                                                <p class="small ms-3 mb-3 rounded-3 text-muted">@request.SubmissionDate.ToString("dd/MM/yyyy HH:mm")</p>
                                                        </div>
                                                    </div>

                                                    <div class="divider d-flex align-items-center mb-4">
                                                            <p class="text-center mx-3 mb-0" style="color: #a2aab7;">@request.Status</p>
                                                    </div>

                                                    <div class="d-flex flex-row justify-content-end mb-4 pt-1">
                                                        <div class="me-3">
                                                                @if (!string.IsNullOrWhiteSpace(request.ResolutionNotes))
                                                                {
                                                                    <p class="small p-2 mb-1 text-white rounded-3 message-outgoing-custom">@request.ResolutionNotes</p>
                                                                }
                                                                else if (request.Status.Equals("Submitted", StringComparison.OrdinalIgnoreCase) || request.Status.Equals("Open", StringComparison.OrdinalIgnoreCase))
                                                                {
                                                                    <em class="text-muted">Chưa có phản hồi</em>
                                                                }
                                                            
                                                        </div>
                                                        <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava2-bg.webp"
                                                             alt="Avatar của bạn" class="chat-avatar">
                                                    </div>
                                                    }

                                                </div>

                                            </div>

                                        </div>
                                    </div>

                                </div>
                            </div>

                        </section>
                    </div>
                </div>
            </div>

        </div>

        <div class="container">
            <div class="row g-4">
                <div class="col-12 col-sm-6 col-lg-4">
                    <div class="contact__card item-stagger">
                        <svg xmlns="http://www.w3.org/2000/svg"
                             width="40"
                             height="40"
                             viewBox="0 0 40 40"
                             fill="none">
                            <path d="M35 16.6667C35 28.3334 20 38.3334 20 38.3334C20 38.3334 5 28.3334 5 16.6667C5 12.6885 6.58035 8.87319 9.3934 6.06015C12.2064 3.2471 16.0218 1.66675 20 1.66675C23.9782 1.66675 27.7936 3.2471 30.6066 6.06015C33.4196 8.87319 35 12.6885 35 16.6667Z"
                                  stroke="currentColor"
                                  stroke-width="2"
                                  stroke-linecap="round"
                                  stroke-linejoin="round" />
                            <path d="M20 21.6667C22.7614 21.6667 25 19.4282 25 16.6667C25 13.9053 22.7614 11.6667 20 11.6667C17.2386 11.6667 15 13.9053 15 16.6667C15 19.4282 17.2386 21.6667 20 21.6667Z"
                                  stroke="currentColor"
                                  stroke-width="2"
                                  stroke-linecap="round"
                                  stroke-linejoin="round" />
                        </svg>
                        <div class="card-content">
                            <span>Location</span>
                            <p>20,Love Street, Muscat, Oman</p>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-sm-6 col-lg-4">
                    <div class="contact__card item-stagger">
                        <svg xmlns="http://www.w3.org/2000/svg"
                             width="40"
                             height="40"
                             viewBox="0 0 40 40"
                             fill="none">
                            <path d="M25.0835 8.33341C26.7114 8.65102 28.2075 9.44718 29.3803 10.62C30.5531 11.7928 31.3493 13.2889 31.6669 14.9167M25.0835 1.66675C28.4657 2.04248 31.6195 3.55704 34.0273 5.96176C36.435 8.36648 37.9536 11.5184 38.3335 14.9001M36.6669 28.2001V33.2001C36.6688 33.6642 36.5737 34.1237 36.3877 34.549C36.2018 34.9743 35.929 35.3561 35.587 35.6699C35.245 35.9837 34.8412 36.2226 34.4015 36.3713C33.9618 36.52 33.4958 36.5752 33.0335 36.5334C27.9049 35.9761 22.9785 34.2237 18.6502 31.4167C14.6233 28.8579 11.2091 25.4437 8.65021 21.4167C5.83351 17.0688 4.08062 12.1184 3.53355 6.96675C3.4919 6.50586 3.54667 6.04135 3.69438 5.60279C3.84209 5.16423 4.0795 4.76123 4.39149 4.41945C4.70348 4.07767 5.08322 3.8046 5.50653 3.61762C5.92984 3.43064 6.38745 3.33385 6.85021 3.33341H11.8502C12.6591 3.32545 13.4432 3.61188 14.0565 4.1393C14.6698 4.66673 15.0703 5.39916 15.1835 6.20008C15.3946 7.80019 15.786 9.37129 16.3502 10.8834C16.5745 11.48 16.623 12.1283 16.4901 12.7515C16.3571 13.3748 16.0483 13.9469 15.6002 14.4001L13.4835 16.5167C15.8561 20.6893 19.311 24.1442 23.4835 26.5167L25.6002 24.4001C26.0534 23.952 26.6255 23.6432 27.2487 23.5102C27.872 23.3773 28.5203 23.4258 29.1169 23.6501C30.629 24.2143 32.2001 24.6057 33.8002 24.8167C34.6098 24.931 35.3492 25.3388 35.8778 25.9626C36.4063 26.5864 36.6872 27.3827 36.6669 28.2001Z"
                                  stroke="currentColor"
                                  stroke-width="2"
                                  stroke-linecap="round"
                                  stroke-linejoin="round" />
                        </svg>
                        <div class="card-content">
                            <span>Phone</span>
                            <a href="tel:+9689999000">+968 9999000</a>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-sm-6 col-lg-4">
                    <div class="contact__card item-stagger">
                        <svg xmlns="http://www.w3.org/2000/svg"
                             width="40"
                             height="40"
                             viewBox="0 0 40 40"
                             fill="none">
                            <path d="M6.66683 6.66675H33.3335C35.1668 6.66675 36.6668 8.16675 36.6668 10.0001V30.0001C36.6668 31.8334 35.1668 33.3334 33.3335 33.3334H6.66683C4.8335 33.3334 3.3335 31.8334 3.3335 30.0001V10.0001C3.3335 8.16675 4.8335 6.66675 6.66683 6.66675Z"
                                  stroke="currentColor"
                                  stroke-width="2"
                                  stroke-linecap="round"
                                  stroke-linejoin="round" />
                            <path d="M36.6668 10L20.0002 21.6667L3.3335 10"
                                  stroke="currentColor"
                                  stroke-width="2"
                                  stroke-linecap="round"
                                  stroke-linejoin="round" />
                        </svg>
                        <div class="card-content">
                            <span>email</span>
                            <a href="mailto:support@trisog.com">support@trisog.com</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row g-4 section-mini-padding-top">
                <div class="col-md-6 order-1 order-md-0">
                    <div class="contact__form-area">
                        
                    </div>
                </div>
                <div class="col-md-6 order-0 order-md-1">
                    <div class="contact__content">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d158948.56028719185!2d-0.17642604842689577!3d51.50273490000001!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47d8a97e5064c4af%3A0xe5ec06faa0e968d8!2sThemeOforest!5e0!3m2!1sen!2sbd!4v1732351300070!5m2!1sen!2sbd"
                                width="570"
                                height="412"
                                style="border: 0"
                                allowfullscreen=""
                                loading="lazy"
                                referrerpolicy="no-referrer-when-downgrade"
                                class="contact-map"></iframe>
                    </div>
                </div>
            </div>
        </div>

    </section>

    <section class="contact__section section-padding-top-bottom">
        
    </section>

    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.3.2/mdb.umd.min.js"></script>
</body>
</html>



@* Section để load các script validation phía client (nếu bạn dùng) *@
@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}